{"openapi":"3.0.0","paths":{"/api/metrics":{"get":{"description":"Returns a snapshot of real-time server metrics, including uptime, connection counts, email statistics, and certificate status.","operationId":"MetricsController_getMetrics","parameters":[],"responses":{"200":{"description":"Metrics retrieved successfully.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MetricsResponseDto"}}}},"401":{"description":"Unauthorized, API key is missing or invalid."}},"security":[{"api-key":[]}],"summary":"Get Application Metrics","tags":["Metrics"]}},"/api/metrics/storage":{"get":{"description":"Returns real-time storage metrics including memory utilization, email counts, eviction statistics, and tombstone tracking.","operationId":"MetricsController_getStorageMetrics","parameters":[],"responses":{"200":{"description":"Storage metrics retrieved successfully.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/StorageMetricsResponseDto"}}}},"401":{"description":"Unauthorized, API key is missing or invalid."}},"security":[{"api-key":[]}],"summary":"Get Email Storage Metrics","tags":["Metrics"]}},"/api/sse-console/stream":{"get":{"description":"Establishes an SSE connection to receive real-time console-style log messages.","operationId":"SseConsoleController_stream","parameters":[],"responses":{"200":{"description":"SSE connection established. The stream will send log messages as they occur. Messages have the structure: { type: string, text: string, timestamp: string } and are HTML-escaped on the server."},"401":{"description":"Unauthorized, API key is missing or invalid."}},"security":[{"api-key":[]}],"summary":"Subscribe to server console logs","tags":["SSE Console"]}},"/api/check-key":{"get":{"description":"A simple endpoint to check if the provided X-API-Key header is valid.","operationId":"InboxController_getCheckKey","parameters":[],"responses":{"200":{"description":"API key is valid.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CheckKeyResponseDto"}}}},"401":{"description":"Unauthorized, API key is missing or invalid."}},"security":[{"api-key":[]}],"summary":"Validate API Key","tags":["Inbox"]}},"/api/server-info":{"get":{"description":"Returns the server public signature key for verifying server-sent data.","operationId":"InboxController_getServerInfo","parameters":[],"responses":{"200":{"description":"Server information retrieved successfully.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ServerInfoResponseDto"}}}},"401":{"description":"Unauthorized, API key is missing or invalid."}},"security":[{"api-key":[]}],"summary":"Get Server Cryptographic Info","tags":["Inbox"]}},"/api/inboxes":{"post":{"operationId":"InboxController_createInbox","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateInboxDto"}}}},"responses":{"201":{"description":"The inbox has been successfully created.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateInboxResponseDto"}}}},"401":{"description":"Unauthorized, API key is missing or invalid."}},"security":[{"api-key":[]}],"summary":"Create a new inbox","tags":["Inbox"]},"delete":{"description":"Deletes all inboxes and their emails. Use with caution.","operationId":"InboxController_clearAllInboxes","parameters":[],"responses":{"200":{"description":"All inboxes have been cleared.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ClearAllInboxesResponseDto"}}}},"401":{"description":"Unauthorized, API key is missing or invalid."},"403":{"description":"Forbidden, clear all inboxes is disabled via VSB_LOCAL_ALLOW_CLEAR_ALL_INBOXES."}},"security":[{"api-key":[]}],"summary":"Clear all inboxes","tags":["Inbox"]}},"/api/inboxes/{emailAddress}/emails":{"get":{"operationId":"InboxController_listEmails","parameters":[{"name":"emailAddress","required":true,"in":"path","description":"The email address of the inbox.","schema":{"type":"string"}},{"name":"includeContent","required":false,"in":"query","description":"When true, includes encryptedParsed content in each email item.","schema":{"type":"boolean"}}],"responses":{"200":{"description":"A list of emails in the inbox.","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/EmailListItemDto"}}}}},"401":{"description":"Unauthorized, API key is missing or invalid."},"404":{"description":"Inbox not found."}},"security":[{"api-key":[]}],"summary":"List emails in an inbox","tags":["Inbox"]}},"/api/inboxes/{emailAddress}/sync":{"get":{"operationId":"InboxController_getInboxSyncStatus","parameters":[{"name":"emailAddress","required":true,"in":"path","description":"The email address of the inbox.","schema":{"type":"string"}}],"responses":{"200":{"description":"The synchronization status of the inbox.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SyncStatusResponseDto"}}}},"401":{"description":"Unauthorized, API key is missing or invalid."},"404":{"description":"Inbox not found."}},"security":[{"api-key":[]}],"summary":"Get inbox synchronization status","tags":["Inbox"]}},"/api/inboxes/{emailAddress}/emails/{emailId}":{"get":{"operationId":"InboxController_getEmail","parameters":[{"name":"emailAddress","required":true,"in":"path","description":"The email address of the inbox.","schema":{"type":"string"}},{"name":"emailId","required":true,"in":"path","description":"The ID of the email to retrieve.","schema":{"type":"string"}}],"responses":{"200":{"description":"The requested email.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EmailResponseDto"}}}},"401":{"description":"Unauthorized, API key is missing or invalid."},"404":{"description":"Email or inbox not found."}},"security":[{"api-key":[]}],"summary":"Get a specific email","tags":["Inbox"]},"delete":{"operationId":"InboxController_deleteEmail","parameters":[{"name":"emailAddress","required":true,"in":"path","description":"The email address of the inbox.","schema":{"type":"string"}},{"name":"emailId","required":true,"in":"path","description":"The ID of the email to delete.","schema":{"type":"string"}}],"responses":{"204":{"description":"Email deleted successfully."},"401":{"description":"Unauthorized, API key is missing or invalid."},"404":{"description":"Email or inbox not found."}},"security":[{"api-key":[]}],"summary":"Delete a single email","tags":["Inbox"]}},"/api/inboxes/{emailAddress}/emails/{emailId}/raw":{"get":{"operationId":"InboxController_getRawEmail","parameters":[{"name":"emailAddress","required":true,"in":"path","description":"The email address of the inbox.","schema":{"type":"string"}},{"name":"emailId","required":true,"in":"path","description":"The ID of the email to retrieve.","schema":{"type":"string"}}],"responses":{"200":{"description":"The raw content of the requested email.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RawEmailResponseDto"}}}},"401":{"description":"Unauthorized, API key is missing or invalid."},"404":{"description":"Email or inbox not found."}},"security":[{"api-key":[]}],"summary":"Get the raw content of an email","tags":["Inbox"]}},"/api/inboxes/{emailAddress}/emails/{emailId}/read":{"patch":{"operationId":"InboxController_markEmailAsRead","parameters":[{"name":"emailAddress","required":true,"in":"path","description":"The email address of the inbox.","schema":{"type":"string"}},{"name":"emailId","required":true,"in":"path","description":"The ID of the email to mark as read.","schema":{"type":"string"}}],"responses":{"204":{"description":"Email marked as read successfully."},"401":{"description":"Unauthorized, API key is missing or invalid."},"404":{"description":"Email or inbox not found."}},"security":[{"api-key":[]}],"summary":"Mark an email as read","tags":["Inbox"]}},"/api/inboxes/{emailAddress}":{"delete":{"description":"Deletes an inbox and all associated emails. Returns 204 No Content regardless of whether the inbox exists (idempotent delete).","operationId":"InboxController_deleteInbox","parameters":[{"name":"emailAddress","required":true,"in":"path","description":"The email address of the inbox to delete.","schema":{"type":"string"}}],"responses":{"204":{"description":"Inbox deleted successfully, or inbox did not exist (idempotent delete)."},"401":{"description":"Unauthorized, API key is missing or invalid."}},"security":[{"api-key":[]}],"summary":"Delete an inbox","tags":["Inbox"]}},"/api/events":{"get":{"description":"Establishes a Server-Sent Events (SSE) connection to receive real-time notifications about new emails.","operationId":"EventsController_stream","parameters":[{"name":"inboxes","required":true,"in":"query","description":"Comma-separated list of inbox hashes to subscribe to.","schema":{"type":"string"}}],"responses":{"200":{"description":"SSE connection established. The stream will send events as they occur.","headers":{"Content-Type":{"schema":{"type":"string","example":"text/event-stream"}}},"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NewEmailEventDto"}}}},"401":{"description":"Unauthorized, API key is missing or invalid."}},"security":[{"api-key":[]}],"summary":"Subscribe to new email events","tags":["Events"]}},"/health":{"get":{"description":"Performs a health check on the application and its dependencies, such as SMTP server, backend connectivity, and certificate status.","operationId":"HealthController_check","parameters":[],"responses":{"200":{"description":"The Health Check is successful","content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","example":"ok"},"info":{"type":"object","example":{"database":{"status":"up"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true},"nullable":true},"error":{"type":"object","example":{},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true},"nullable":true},"details":{"type":"object","example":{"database":{"status":"up"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true}}}}}}},"503":{"description":"The Health Check is not successful","content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","example":"error"},"info":{"type":"object","example":{"database":{"status":"up"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true},"nullable":true},"error":{"type":"object","example":{"redis":{"status":"down","message":"Could not connect"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true},"nullable":true},"details":{"type":"object","example":{"database":{"status":"up"},"redis":{"status":"down","message":"Could not connect"}},"additionalProperties":{"type":"object","required":["status"],"properties":{"status":{"type":"string"}},"additionalProperties":true}}}}}}}},"summary":"Get Application Health Status","tags":["Health"]}},"/api/test/emails":{"post":{"description":"Creates a test email with controlled authentication results (SPF, DKIM, DMARC, ReverseDNS). This endpoint is only available when VSB_SDK_DEVELOPMENT=true.","operationId":"TestController_createTestEmail","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateTestEmailDto"}}}},"responses":{"201":{"description":"The test email has been successfully created.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateTestEmailResponseDto"}}}},"401":{"description":"Unauthorized, API key is missing or invalid."},"404":{"description":"Inbox not found."}},"security":[{"api-key":[]}],"summary":"Create a test email","tags":["Test"]}}},"info":{"title":"VaultSandbox Gateway API","description":"The API documentation for the VaultSandbox Gateway.","version":"1.0","contact":{}},"tags":[],"servers":[],"components":{"securitySchemes":{"api-key":{"type":"apiKey","in":"header","name":"X-API-Key"}},"schemas":{"ConnectionMetricsDto":{"type":"object","properties":{"total":{"type":"number","description":"Total number of connections established","example":150},"active":{"type":"number","description":"Number of currently active connections","example":5},"rejected":{"type":"number","description":"Total number of connections that were rejected","example":2}},"required":["total","active","rejected"]},"InboxMetricsDto":{"type":"object","properties":{"created_total":{"type":"number","description":"Total number of inboxes created","example":42},"deleted_total":{"type":"number","description":"Total number of inboxes deleted","example":12},"active_total":{"type":"number","description":"Number of currently active inboxes","example":30}},"required":["created_total","deleted_total","active_total"]},"EmailMetricsDto":{"type":"object","properties":{"received_total":{"type":"number","description":"Total number of emails received","example":1024},"recipients_total":{"type":"number","description":"Total number of email recipients processed","example":1256},"processing_time_ms":{"type":"number","description":"Average processing time in milliseconds for email handling","example":150}},"required":["received_total","recipients_total","processing_time_ms"]},"RejectionMetricsDto":{"type":"object","properties":{"invalid_commands":{"type":"number","description":"Number of invalid SMTP commands received","example":3},"sender_rejected_total":{"type":"number","description":"Total number of senders that were rejected","example":5},"recipient_rejected_total":{"type":"number","description":"Total number of recipients that were rejected","example":8},"data_rejected_size_total":{"type":"number","description":"Total number of emails rejected due to size limits","example":2},"hard_mode_total":{"type":"number","description":"Total number of rejections due to hard mode enforcement","example":0},"rate_limit_total":{"type":"number","description":"Total number of rejections due to rate limiting","example":1}},"required":["invalid_commands","sender_rejected_total","recipient_rejected_total","data_rejected_size_total","hard_mode_total","rate_limit_total"]},"AuthMetricsDto":{"type":"object","properties":{"spf_pass":{"type":"number","description":"Number of emails passing SPF verification","example":980},"spf_fail":{"type":"number","description":"Number of emails failing SPF verification","example":44},"dkim_pass":{"type":"number","description":"Number of emails passing DKIM verification","example":950},"dkim_fail":{"type":"number","description":"Number of emails failing DKIM verification","example":74},"dmarc_pass":{"type":"number","description":"Number of emails passing DMARC verification","example":920},"dmarc_fail":{"type":"number","description":"Number of emails failing DMARC verification","example":104}},"required":["spf_pass","spf_fail","dkim_pass","dkim_fail","dmarc_pass","dmarc_fail"]},"CertificateMetricsDto":{"type":"object","properties":{"days_until_expiry":{"type":"number","description":"Number of days until the certificate expires","example":45},"renewal_attempts":{"type":"number","description":"Number of certificate renewal attempts made","example":3},"renewal_success":{"type":"number","description":"Number of successful certificate renewals","example":3},"renewal_failures":{"type":"number","description":"Number of failed certificate renewal attempts","example":0}},"required":["days_until_expiry","renewal_attempts","renewal_success","renewal_failures"]},"ServerMetricsDto":{"type":"object","properties":{"uptime_seconds":{"type":"number","description":"Server uptime in seconds since last restart","example":86400}},"required":["uptime_seconds"]},"MetricsResponseDto":{"type":"object","properties":{"connections":{"description":"Connection-related metrics","allOf":[{"$ref":"#/components/schemas/ConnectionMetricsDto"}]},"inbox":{"description":"Inbox-related metrics","allOf":[{"$ref":"#/components/schemas/InboxMetricsDto"}]},"email":{"description":"Email processing metrics","allOf":[{"$ref":"#/components/schemas/EmailMetricsDto"}]},"rejections":{"description":"Rejection metrics","allOf":[{"$ref":"#/components/schemas/RejectionMetricsDto"}]},"auth":{"description":"Authentication metrics for SPF, DKIM, and DMARC","allOf":[{"$ref":"#/components/schemas/AuthMetricsDto"}]},"certificate":{"description":"Certificate status and renewal metrics","allOf":[{"$ref":"#/components/schemas/CertificateMetricsDto"}]},"server":{"description":"Server uptime and availability metrics","allOf":[{"$ref":"#/components/schemas/ServerMetricsDto"}]}},"required":["connections","inbox","email","rejections","auth","certificate","server"]},"StorageStatsDto":{"type":"object","properties":{"maxMemoryBytes":{"type":"number","description":"Maximum configured memory in bytes","example":524288000},"maxMemoryMB":{"type":"string","description":"Maximum configured memory in megabytes (stringified)","example":"500.00"},"usedMemoryBytes":{"type":"number","description":"Currently used memory in bytes","example":157286400},"usedMemoryMB":{"type":"string","description":"Currently used memory in megabytes (stringified)","example":"150.00"},"availableMemoryBytes":{"type":"number","description":"Available memory in bytes","example":367001600},"availableMemoryMB":{"type":"string","description":"Available memory in megabytes (stringified)","example":"350.00"},"utilizationPercent":{"type":"string","description":"Memory utilization percentage (stringified)","example":"30.00"}},"required":["maxMemoryBytes","maxMemoryMB","usedMemoryBytes","usedMemoryMB","availableMemoryBytes","availableMemoryMB","utilizationPercent"]},"EmailStatsDto":{"type":"object","properties":{"totalStored":{"type":"number","description":"Total emails currently stored (non-evicted)","example":1250},"totalEvicted":{"type":"number","description":"Total emails evicted to free memory","example":450},"tombstones":{"type":"number","description":"Number of tombstoned entries awaiting compaction","example":85},"oldestEmailAge":{"type":"object","description":"Age in ms of the oldest stored email","example":3600000,"nullable":true},"newestEmailAge":{"type":"object","description":"Age in ms of the newest stored email","example":1500,"nullable":true}},"required":["totalStored","totalEvicted","tombstones","oldestEmailAge","newestEmailAge"]},"EvictionStatsDto":{"type":"object","properties":{"maxAgeSeconds":{"type":"object","description":"Maximum age in seconds before time-based eviction","example":3600,"nullable":true},"maxAgeEnabled":{"type":"boolean","description":"Whether time-based eviction is enabled","example":false}},"required":["maxAgeSeconds","maxAgeEnabled"]},"StorageMetricsResponseDto":{"type":"object","properties":{"storage":{"description":"Memory usage statistics","allOf":[{"$ref":"#/components/schemas/StorageStatsDto"}]},"emails":{"description":"Email storage counters","allOf":[{"$ref":"#/components/schemas/EmailStatsDto"}]},"eviction":{"description":"Eviction configuration and status","allOf":[{"$ref":"#/components/schemas/EvictionStatsDto"}]}},"required":["storage","emails","eviction"]},"CheckKeyResponseDto":{"type":"object","properties":{"ok":{"type":"boolean","description":"Indicates if the API key is valid","example":true}},"required":["ok"]},"AlgorithmsDto":{"type":"object","properties":{"kem":{"type":"string","description":"Key encapsulation mechanism algorithm","example":"ML-KEM-768"},"sig":{"type":"string","description":"Digital signature algorithm","example":"ML-DSA-65"},"aead":{"type":"string","description":"Authenticated encryption algorithm","example":"AES-256-GCM"},"kdf":{"type":"string","description":"Key derivation function","example":"HKDF-SHA-512"}},"required":["kem","sig","aead","kdf"]},"ServerInfoResponseDto":{"type":"object","properties":{"serverSigPk":{"type":"string","description":"Base64URL-encoded server signing public key for ML-DSA-65","example":"base64url-encoded-public-key"},"algs":{"description":"Cryptographic algorithms supported by the server","allOf":[{"$ref":"#/components/schemas/AlgorithmsDto"}]},"context":{"type":"string","description":"Context string for the encryption scheme","example":"vaultsandbox:email:v1"},"maxTtl":{"type":"number","description":"Maximum time-to-live for inboxes in seconds","example":86400},"defaultTtl":{"type":"number","description":"Default time-to-live for inboxes in seconds","example":3600},"sseConsole":{"type":"boolean","description":"If server sse console is enabled","example":false},"allowClearAllInboxes":{"type":"boolean","description":"If the clear all inboxes endpoint is enabled","example":true},"allowedDomains":{"description":"List of domains allowed for inbox creation","example":["vaultsandbox.test","example.com"],"type":"array","items":{"type":"string"}},"encryptionPolicy":{"type":"string","description":"Server encryption policy. \"always\"/\"never\" are locked (per-inbox override ignored). \"enabled\"/\"disabled\" allow per-inbox override.","enum":["always","enabled","disabled","never"],"example":"always"}},"required":["serverSigPk","algs","context","maxTtl","defaultTtl","sseConsole","allowClearAllInboxes","allowedDomains","encryptionPolicy"]},"CreateInboxDto":{"type":"object","properties":{"clientKemPk":{"type":"string","description":"Base64URL-encoded ML-KEM-768 public key for key encapsulation. Required when encryption is enabled.","example":"base64url-encoded-public-key"},"ttl":{"type":"number","description":"Time-to-live for the inbox in seconds. Defaults to 1 hour.","minimum":60,"maximum":604800},"emailAddress":{"type":"string","description":"Optional desired email address or domain. If not provided, a random address will be generated.","example":"user@example.com","maxLength":254},"encryption":{"type":"string","description":"Encryption preference. Omit to use server default. Ignored if server is locked to \"always\" or \"never\".","enum":["encrypted","plain"],"example":"encrypted"},"emailAuth":{"type":"boolean","description":"Email authentication (SPF, DKIM, DMARC, PTR) preference. Omit to use server default (VSB_EMAIL_AUTH_INBOX_DEFAULT).","example":true}}},"CreateInboxResponseDto":{"type":"object","properties":{"emailAddress":{"type":"string","description":"The email address assigned to the inbox","example":"abc12345@vaultsandbox.test"},"expiresAt":{"type":"string","description":"ISO 8601 timestamp when the inbox will expire","example":"2025-01-21T12:00:00.000Z"},"inboxHash":{"type":"string","description":"Unique inbox identifier (Base64URL SHA-256 hash). Derived from clientKemPk when encrypted, or email address when plain.","example":"base64url-encoded-inbox-hash"},"encrypted":{"type":"boolean","description":"Whether encryption is enabled for this inbox","example":true},"emailAuth":{"type":"boolean","description":"Whether email authentication (SPF, DKIM, DMARC, PTR) is enabled for this inbox","example":true},"serverSigPk":{"type":"string","description":"Base64URL-encoded server signing public key for verifying server signatures. Only present when encrypted is true.","example":"base64url-encoded-server-public-key"}},"required":["emailAddress","expiresAt","inboxHash","encrypted","emailAuth"]},"EncryptedPayloadDto":{"type":"object","properties":{"v":{"type":"number","description":"Protocol version","example":1},"algs":{"type":"object","description":"Cryptographic algorithms used","example":{"kem":"ML-KEM-768","sig":"ML-DSA-65","aead":"AES-256-GCM","kdf":"HKDF-SHA-512"}},"ct_kem":{"type":"string","description":"Base64URL-encoded KEM ciphertext","example":"base64url-encoded-kem-ciphertext"},"nonce":{"type":"string","description":"Base64URL-encoded 12-byte nonce","example":"base64url-encoded-nonce"},"aad":{"type":"string","description":"Base64URL-encoded additional authenticated data","example":"base64url-encoded-aad"},"ciphertext":{"type":"string","description":"Base64URL-encoded AES-GCM ciphertext (includes authentication tag)","example":"base64url-encoded-ciphertext"},"sig":{"type":"string","description":"Base64URL-encoded ML-DSA digital signature","example":"base64url-encoded-signature"},"server_sig_pk":{"type":"string","description":"Base64URL-encoded server signing public key","example":"base64url-encoded-server-public-key"}},"required":["v","algs","ct_kem","nonce","aad","ciphertext","sig","server_sig_pk"]},"EmailListItemDto":{"type":"object","properties":{"id":{"type":"string","description":"Unique identifier for the email (UUID)","example":"550e8400-e29b-41d4-a716-446655440000"},"encryptedMetadata":{"description":"Encrypted email metadata (contains id, from, subject, receivedAt)","allOf":[{"$ref":"#/components/schemas/EncryptedPayloadDto"}]},"isRead":{"type":"boolean","description":"Indicates if the email has been marked as read","example":false},"encryptedParsed":{"description":"Encrypted parsed email content (only included when includeContent=true)","allOf":[{"$ref":"#/components/schemas/EncryptedPayloadDto"}]}},"required":["id","encryptedMetadata","isRead"]},"SyncStatusResponseDto":{"type":"object","properties":{"emailsHash":{"type":"string","description":"SHA-256 hash of sorted email IDs for synchronization checks","example":"base64url-encoded-emails-hash"},"emailCount":{"type":"number","description":"Total number of emails in the inbox","example":5}},"required":["emailsHash","emailCount"]},"EmailResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"Unique identifier for the email (UUID)","example":"550e8400-e29b-41d4-a716-446655440000"},"encryptedMetadata":{"description":"Encrypted email metadata (contains id, from, subject, receivedAt)","allOf":[{"$ref":"#/components/schemas/EncryptedPayloadDto"}]},"encryptedParsed":{"description":"Encrypted parsed email content (text, html, attachments)","allOf":[{"$ref":"#/components/schemas/EncryptedPayloadDto"}]},"isRead":{"type":"boolean","description":"Indicates if the email has been marked as read","example":false}},"required":["id","encryptedMetadata","encryptedParsed","isRead"]},"RawEmailResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"Unique identifier for the email (UUID)","example":"550e8400-e29b-41d4-a716-446655440000"},"encryptedRaw":{"description":"Encrypted raw email source","allOf":[{"$ref":"#/components/schemas/EncryptedPayloadDto"}]}},"required":["id","encryptedRaw"]},"ClearAllInboxesResponseDto":{"type":"object","properties":{"deleted":{"type":"number","description":"Number of inboxes deleted","example":10}},"required":["deleted"]},"NewEmailEventDto":{"type":"object","properties":{"inboxId":{"type":"string","description":"The inbox hash that received the email","example":"base64url-encoded-inbox-hash"},"emailId":{"type":"string","description":"Unique identifier for the email (UUID)","example":"550e8400-e29b-41d4-a716-446655440000"},"encryptedMetadata":{"description":"End-to-end encrypted email metadata (id, from, to, subject, receivedAt). Uses AES-256-GCM with ML-KEM-768 key encapsulation and ML-DSA-65 signatures.","allOf":[{"$ref":"#/components/schemas/EncryptedPayloadDto"}]}},"required":["inboxId","emailId","encryptedMetadata"]},"AuthOptionsDto":{"type":"object","properties":{"spf":{"type":"string","description":"SPF authentication result","enum":["pass","fail","softfail","neutral","none","temperror","permerror"],"default":"pass"},"dkim":{"type":"string","description":"DKIM authentication result","enum":["pass","fail","none"],"default":"pass"},"dmarc":{"type":"string","description":"DMARC authentication result","enum":["pass","fail","none"],"default":"pass"},"reverseDns":{"type":"string","description":"Reverse DNS verification result","enum":["pass","fail","none"],"default":"pass"}}},"CreateTestEmailDto":{"type":"object","properties":{"to":{"type":"string","description":"Inbox email address to deliver the test email to","example":"inbox@vaultsandbox.test"},"from":{"type":"string","description":"Sender email address","example":"sender@example.com","default":"test@vaultsandbox.test"},"subject":{"type":"string","description":"Email subject line","example":"Test Email Subject","default":"Test Email"},"text":{"type":"string","description":"Plain text email body","example":"This is the plain text body of the test email.","default":"Test email body"},"html":{"type":"string","description":"HTML email body","example":"<p>This is the HTML body of the test email.</p>"},"auth":{"description":"Controlled authentication results for the test email","allOf":[{"$ref":"#/components/schemas/AuthOptionsDto"}]}},"required":["to"]},"CreateTestEmailResponseDto":{"type":"object","properties":{}}}}}